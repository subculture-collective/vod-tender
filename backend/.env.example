# vod-tender backend environment example
# Copy to backend/.env and fill in real secrets (do NOT commit real credentials)

# --- Twitch Chat / OAuth (user access token for chat) ---
TWITCH_CHANNEL=your_channel_name
TWITCH_BOT_USERNAME=your_bot_username
TWITCH_OAUTH_TOKEN=

# --- Twitch Application Credentials (for app & auth code flow) ---
TWITCH_CLIENT_ID=your_twitch_app_client_id
TWITCH_CLIENT_SECRET=your_twitch_app_client_secret
TWITCH_REDIRECT_URI=http://localhost:8080/auth/twitch/callback
TWITCH_SCOPES=chat:read chat:edit

# --- VOD Context ---
TWITCH_VOD_ID=123456789
TWITCH_VOD_START=2025-08-12T19:03:00Z
about:blank#blocked
# --- Database & Storage ---
# Postgres DSN (matches docker-compose service 'postgres')
DB_DSN=postgres://vod:vod@postgres:5432/vod?sslmode=disable
DATA_DIR=data

# --- OAuth Token Encryption (REQUIRED for production) ---
# Base64-encoded 32-byte key for AES-256-GCM encryption of OAuth tokens at rest
# Generate with: openssl rand -base64 32
# WARNING: If not set, tokens are stored in PLAINTEXT (acceptable for local dev only)
# Store this key securely (AWS Secrets Manager, HashiCorp Vault, etc.)
ENCRYPTION_KEY=

# --- YouTube (optional future integration) ---
YT_CREDENTIALS_FILE=
YT_CREDENTIALS_JSON=
YT_TOKEN_FILE=
YT_TOKEN_JSON=

# YouTube OAuth
YT_CLIENT_ID=
YT_CLIENT_SECRET=
YT_REDIRECT_URI=https://vod-api.onnwee.me/auth/youtube/callback
# Comma separated scopes (joined into space list) or leave blank to use default upload scope
YT_SCOPES=

# --- Server (optional) ---
# HTTP_ADDR=:8080

# --- Tracing (optional) ---
# OTEL_EXPORTER_OTLP_ENDPOINT=jaeger:4317
# Sample rate for traces (0.0 to 1.0). Default: 1.0 (all traces).
# For production, set to 0.1 (10%) to reduce trace volume.
# OTEL_TRACE_SAMPLE_RATE=0.1

# --- Admin Authentication & Security (REQUIRED for production) ---
# Protect admin endpoints (/admin/*) with authentication
# Option 1: Basic Auth (username + password)
ADMIN_USERNAME=
ADMIN_PASSWORD=
# Option 2: Token-based auth (X-Admin-Token header)
ADMIN_TOKEN=
# Generate secure credentials:
#   Password: openssl rand -base64 24
#   Token: openssl rand -hex 32

# --- Rate Limiting (enabled by default) ---
# Protect admin and sensitive endpoints from abuse
# RATE_LIMIT_ENABLED=1
# RATE_LIMIT_REQUESTS_PER_IP=10
# RATE_LIMIT_WINDOW_SECONDS=60

# --- CORS (Cross-Origin Resource Sharing) ---
# ENV=dev  # dev/development = permissive CORS (*), production = restricted
# CORS_PERMISSIVE=1  # Force permissive mode (not recommended for production)
# CORS_ALLOWED_ORIGINS=https://vod.example.com,https://vod-admin.example.com,*.apps.example.com

# Guidance:
# 1. Run backend, visit /auth/twitch/start to authorize and store tokens.
# 2. Chat uses TWITCH_OAUTH_TOKEN if set; otherwise loads stored token from DB.
# 3. Keep real .env out of version control.
# 4. For production: Set ADMIN_USERNAME+ADMIN_PASSWORD or ADMIN_TOKEN
# 5. For production: Set ENV=production and CORS_ALLOWED_ORIGINS
